<div class="container">
  <h2>Gestió d'usuaris</h2>

  @if (users$ | async; as users) {

  <div class="list-users">

    @for (u of users; track u.email) {
    <div class="user-card">

      <img class="avatar" [src]="u?.photoURL || 'assets/avatar-placeholder.png'" alt="avatar" class="avatar" />

      <div class="info">
        <div class="name">{{ u.displayName || u.email || 'Usuari' }}</div>
        <div class="secondary">{{ u.email }}</div>
      </div>

      <div class="roles">
        <mat-slide-toggle [checked]="u.roles?.admin" (change)="toggleAdmin(u, $event)">
          <mat-icon>admin_panel_settings</mat-icon>
        </mat-slide-toggle>
        
        <mat-slide-toggle [checked]="u.roles?.teacher" (change)="toggleTeacher(u, $event)">
          <mat-icon>school</mat-icon>
        </mat-slide-toggle>

        <mat-slide-toggle [checked]="u.roles?.student" (change)="toggleStudent(u, $event)">
          <mat-icon>person</mat-icon>  
        </mat-slide-toggle>
      </div>

      <div class="actions">
        <button mat-icon-button color="warn" (click)="removeUserDoc(u)">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>
    }
  </div>

  }
  @else {
  <p>No hi ha usuaris registrats (s'espera una col·lecció `users` a Firestore).</p>
  }
</div>